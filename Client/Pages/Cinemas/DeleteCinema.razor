@page "/cinema/delete"
@inject HttpClient Http
@inject NavigationManager NavigationManager
@inject IJSRuntime jsRuntime

@if (Cinemas != null)
{
  <ListWithAction ItemList="@Cinemas" Callback="CallBack" IconName="fas fa-trash-alt">
    @context.Name @context.City
   </ListWithAction>
}

@code {
    public List<Cinema> Cinemas { get; set; } = null;
    public Cinema SelectedCinema { get; set; } = null;
    protected async override Task OnInitializedAsync()
    {
      Cinemas = await Http.GetFromJsonAsync<List<Cinema>>("api/cinemas");
    }
    public async void CallBack(Cinema cinema) {

      var response = await Http.DeleteAsync("api/cinemas/" + cinema.CinemaId);
      var index = Cinemas.FirstOrDefault(c => c.CinemaId == cinema.CinemaId);
      if (index != null)
      {
        Cinemas.Remove(index);
        StateHasChanged();
      }
      Console.WriteLine(response);
    }
}
